Тази демонстрация показва как да се използва предварително обучен модел за генериране на Python код на базата на изображение и текстов подканващ сигнал.

[Примерен код](../../../../../../code/06.E2E/E2E_OpenVino_Phi3-vision.ipynb)

Ето обяснение стъпка по стъпка:

1. **Импортиране и настройка**:
   - Необходимите библиотеки и модули се импортират, включително `requests`, `PIL` за обработка на изображения и `transformers` за работа с модела и обработка.

2. **Зареждане и показване на изображението**:
   - Файл с изображение (`demo.png`) се отваря с помощта на библиотеката `PIL` и се показва.

3. **Дефиниране на подканващия сигнал**:
   - Създава се съобщение, което включва изображението и заявка за генериране на Python код за обработка на изображението и запазването му с помощта на `plt` (matplotlib).

4. **Зареждане на процесора**:
   - `AutoProcessor` се зарежда от предварително обучен модел, посочен от директорията `out_dir`. Този процесор ще обработва текстовите и визуалните входове.

5. **Създаване на подканващия сигнал**:
   - Методът `apply_chat_template` се използва за форматиране на съобщението в подканващ сигнал, подходящ за модела.

6. **Обработка на входовете**:
   - Подканващият сигнал и изображението се обработват в тензори, които моделът може да разбере.

7. **Настройка на аргументите за генериране**:
   - Дефинират се аргументи за процеса на генериране на модела, включително максималния брой нови токени за генериране и дали да се използва семплиране на изхода.

8. **Генериране на кода**:
   - Моделът генерира Python код въз основа на входовете и зададените аргументи за генериране. `TextStreamer` се използва за обработка на изхода, като се пропускат подканващият сигнал и специалните токени.

9. **Резултат**:
   - Генерираният код се отпечатва, като той трябва да включва Python код за обработка на изображението и запазването му, както е посочено в подканващия сигнал.

Тази демонстрация илюстрира как да се използва предварително обучен модел с OpenVino за динамично генериране на код въз основа на потребителски входове и изображения.

**Отказ от отговорност**:  
Този документ е преведен с помощта на автоматизирани AI услуги за превод. Въпреки че се стремим към точност, имайте предвид, че автоматизираните преводи може да съдържат грешки или неточности. Оригиналният документ на неговия изходен език трябва да се счита за авторитетен източник. За критична информация се препоръчва професионален превод от човек. Ние не носим отговорност за каквито и да е недоразумения или погрешни тълкувания, произтичащи от използването на този превод.