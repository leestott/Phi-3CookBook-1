# –§–∏–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ Phi3 —Å –ø–æ–º–æ—â—Ç–∞ –Ω–∞ Olive

–í —Ç–æ–∑–∏ –ø—Ä–∏–º–µ—Ä —â–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç–µ Olive, –∑–∞ –¥–∞:

1. –§–∏–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç–µ LoRA –∞–¥–∞–ø—Ç–µ—Ä –∑–∞ –∫–ª–∞—Å–∏—Ñ–∏—Ü–∏—Ä–∞–Ω–µ –Ω–∞ —Ñ—Ä–∞–∑–∏ –∫–∞—Ç–æ Sad, Joy, Fear, Surprise.
1. –°–ª–µ–µ—Ç–µ —Ç–µ–≥–ª–∞—Ç–∞ –Ω–∞ –∞–¥–∞–ø—Ç–µ—Ä–∞ —Å –±–∞–∑–æ–≤–∏—è –º–æ–¥–µ–ª.
1. –û–ø—Ç–∏–º–∏–∑–∏—Ä–∞—Ç–µ –∏ –∫–≤–∞–Ω—Ç—É–≤–∞—Ç–µ –º–æ–¥–µ–ª–∞ –≤ `int4`.

–°—ä—â–æ —Ç–∞–∫–∞ —â–µ –≤–∏ –ø–æ–∫–∞–∂–µ–º –∫–∞–∫ –¥–∞ –∏–∑–≤—ä—Ä—à–∏—Ç–µ –∏–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è —Å —Ñ–∏–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è –º–æ–¥–µ–ª, –∏–∑–ø–æ–ª–∑–≤–∞–π–∫–∏ ONNX Runtime (ORT) Generate API.

> **‚ö†Ô∏è –ó–∞ —Ñ–∏–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —â–µ –≤–∏ –µ –Ω–µ–æ–±—Ö–æ–¥–∏–º –ø–æ–¥—Ö–æ–¥—è—â GPU - –Ω–∞–ø—Ä–∏–º–µ—Ä, A10, V100, A100.**

## üíæ –ò–Ω—Å—Ç–∞–ª–∏—Ä–∞–Ω–µ

–°—ä–∑–¥–∞–π—Ç–µ –Ω–æ–≤–∞ Python –≤–∏—Ä—Ç—É–∞–ª–Ω–∞ —Å—Ä–µ–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑–ø–æ–ª–∑–≤–∞–π–∫–∏ `conda`):

```bash
conda create -n olive-ai python=3.11
conda activate olive-ai
```

–°–ª–µ–¥ —Ç–æ–≤–∞ –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞–π—Ç–µ Olive –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏—Ç–µ –∑–∞ —Ä–∞–±–æ—Ç–Ω–∏—è –ø—Ä–æ—Ü–µ—Å –Ω–∞ —Ñ–∏–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:

```bash
cd Phi-3CookBook/code/04.Finetuning/olive-ort-example
pip install olive-ai[gpu]
pip install -r requirements.txt
```

## üß™ –§–∏–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ Phi3 —Å –ø–æ–º–æ—â—Ç–∞ –Ω–∞ Olive
[Olive –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–∏—è—Ç —Ñ–∞–π–ª](../../../../../code/03.Finetuning/olive-ort-example/phrase-classification.json) —Å—ä–¥—ä—Ä–∂–∞ *—Ä–∞–±–æ—Ç–µ–Ω –ø—Ä–æ—Ü–µ—Å* —Å —Å–ª–µ–¥–Ω–∏—Ç–µ *—Å—Ç—ä–ø–∫–∏*:

Phi3 -> LoRA -> MergeAdapterWeights -> ModelBuilder

–ù–∞ –≤–∏—Å–æ–∫–æ –Ω–∏–≤–æ, —Ç–æ–∑–∏ —Ä–∞–±–æ—Ç–µ–Ω –ø—Ä–æ—Ü–µ—Å —â–µ:

1. –§–∏–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏ Phi3 (–∑–∞ 150 —Å—Ç—ä–ø–∫–∏, –∫–æ–∏—Ç–æ –º–æ–∂–µ—Ç–µ –¥–∞ –ø—Ä–æ–º–µ–Ω–∏—Ç–µ), –∏–∑–ø–æ–ª–∑–≤–∞–π–∫–∏ –¥–∞–Ω–Ω–∏—Ç–µ –æ—Ç [dataset/data-classification.json](../../../../../code/03.Finetuning/olive-ort-example/dataset/dataset-classification.json).
1. –°–ª–µ–µ —Ç–µ–≥–ª–∞—Ç–∞ –Ω–∞ LoRA –∞–¥–∞–ø—Ç–µ—Ä–∞ —Å –±–∞–∑–æ–≤–∏—è –º–æ–¥–µ–ª. –¢–æ–≤–∞ —â–µ –≤–∏ –¥–∞–¥–µ –µ–¥–∏–Ω –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –Ω–∞ –º–æ–¥–µ–ª–∞ –≤ ONNX —Ñ–æ—Ä–º–∞—Ç.
1. Model Builder —â–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–∞ –º–æ–¥–µ–ª–∞ –∑–∞ ONNX runtime *–∏* —â–µ –≥–æ –∫–≤–∞–Ω—Ç—É–≤–∞ –≤ `int4`.

–ó–∞ –¥–∞ –∏–∑–ø—ä–ª–Ω–∏—Ç–µ —Ä–∞–±–æ—Ç–Ω–∏—è –ø—Ä–æ—Ü–µ—Å, –∏–∑–ø—ä–ª–Ω–µ—Ç–µ:

```bash
olive run --config phrase-classification.json
```

–ö–æ–≥–∞—Ç–æ Olive –ø—Ä–∏–∫–ª—é—á–∏, –≤–∞—à–∏—è—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–∞–Ω `int4` —Ñ–∏–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –º–æ–¥–µ–ª Phi3 —â–µ –±—ä–¥–µ –Ω–∞–ª–∏—á–µ–Ω –≤: `code/04.Finetuning/olive-ort-example/models/lora-merge-mb/gpu-cuda_model`.

## üßë‚Äçüíª –ò–Ω—Ç–µ–≥—Ä–∏—Ä–∞–Ω–µ –Ω–∞ —Ñ–∏–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è Phi3 –≤—ä–≤ –≤–∞—à–µ—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ 

–ó–∞ –¥–∞ —Å—Ç–∞—Ä—Ç–∏—Ä–∞—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ:

```bash
python app/app.py --phrase "cricket is a wonderful sport!" --model-path models/lora-merge-mb/gpu-cuda_model
```

–û—Ç–≥–æ–≤–æ—Ä—ä—Ç —Ç—Ä—è–±–≤–∞ –¥–∞ –±—ä–¥–µ –µ–¥–Ω–æ—Å–ª–æ–≤–Ω–∞ –∫–ª–∞—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ —Ñ—Ä–∞–∑–∞—Ç–∞ (Sad/Joy/Fear/Surprise).

**–û—Ç–∫–∞–∑ –æ—Ç –æ—Ç–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç**:  
–¢–æ–∑–∏ –¥–æ–∫—É–º–µ–Ω—Ç –µ –ø—Ä–µ–≤–µ–¥–µ–Ω —Å –ø–æ–º–æ—â—Ç–∞ –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–∞–Ω–∏ AI —É—Å–ª—É–≥–∏ –∑–∞ –ø—Ä–µ–≤–æ–¥. –í—ä–ø—Ä–µ–∫–∏ —á–µ —Å–µ —Å—Ç—Ä–µ–º–∏–º –∫—ä–º —Ç–æ—á–Ω–æ—Å—Ç, –º–æ–ª—è, –∏–º–∞–π—Ç–µ –ø—Ä–µ–¥–≤–∏–¥, —á–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–∞–Ω–∏—Ç–µ –ø—Ä–µ–≤–æ–¥–∏ –º–æ–≥–∞—Ç –¥–∞ —Å—ä–¥—ä—Ä–∂–∞—Ç –≥—Ä–µ—à–∫–∏ –∏–ª–∏ –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç–∏. –û—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏—è—Ç –¥–æ–∫—É–º–µ–Ω—Ç –Ω–∞ –Ω–µ–≥–æ–≤–∏—è –æ—Ä–∏–≥–∏–Ω–∞–ª–µ–Ω –µ–∑–∏–∫ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ —Å—á–∏—Ç–∞ –∑–∞ –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–µ–Ω –∏–∑—Ç–æ—á–Ω–∏–∫. –ó–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å–µ –ø—Ä–µ–ø–æ—Ä—ä—á–≤–∞ –ø—Ä–æ—Ñ–µ—Å–∏–æ–Ω–∞–ª–µ–Ω —á–æ–≤–µ—à–∫–∏ –ø—Ä–µ–≤–æ–¥. –ù–∏–µ –Ω–µ –Ω–æ—Å–∏–º –æ—Ç–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç –∑–∞ –Ω–∏–∫–∞–∫–≤–∏ –Ω–µ–¥–æ—Ä–∞–∑—É–º–µ–Ω–∏—è –∏–ª–∏ –ø–æ–≥—Ä–µ—à–Ω–∏ —Ç—ä–ª–∫—É–≤–∞–Ω–∏—è, –ø—Ä–æ–∏–∑—Ç–∏—á–∞—â–∏ –æ—Ç –∏–∑–ø–æ–ª–∑–≤–∞–Ω–µ—Ç–æ –Ω–∞ —Ç–æ–∑–∏ –ø—Ä–µ–≤–æ–¥.