이 데모는 사전 학습된 모델을 사용하여 이미지와 텍스트 프롬프트를 기반으로 Python 코드를 생성하는 방법을 보여줍니다.

[샘플 코드](../../../../../../code/06.E2E/E2E_OpenVino_Phi3-vision.ipynb)

다음은 단계별 설명입니다:

1. **임포트 및 설정**:
   - 필요한 라이브러리와 모듈이 임포트됩니다. 여기에는 이미지 처리를 위한 `requests`, `PIL`와 모델 및 처리를 다루는 `transformers`가 포함됩니다.

2. **이미지 로드 및 표시**:
   - 이미지 파일(`demo.png`)이 `PIL` 라이브러리를 사용해 열리고 표시됩니다.

3. **프롬프트 정의**:
   - 이미지와 함께 이미지를 처리하고 `plt`(matplotlib)을 사용해 저장하는 Python 코드를 생성하라는 요청이 포함된 메시지가 생성됩니다.

4. **프로세서 로드**:
   - `AutoProcessor`가 `out_dir` 디렉토리에 지정된 사전 학습된 모델에서 로드됩니다. 이 프로세서는 텍스트와 이미지 입력을 처리합니다.

5. **프롬프트 생성**:
   - `apply_chat_template` 메서드를 사용하여 메시지를 모델에 적합한 프롬프트 형식으로 변환합니다.

6. **입력 처리**:
   - 프롬프트와 이미지가 모델이 이해할 수 있는 텐서로 처리됩니다.

7. **생성 인자 설정**:
   - 모델 생성 프로세스를 위한 인자가 정의됩니다. 여기에는 생성할 새 토큰의 최대 개수와 출력 샘플링 여부가 포함됩니다.

8. **코드 생성**:
   - 모델이 입력과 생성 인자에 기반하여 Python 코드를 생성합니다. `TextStreamer`가 출력 처리를 담당하며, 프롬프트와 특수 토큰을 건너뜁니다.

9. **출력**:
   - 생성된 코드는 출력되며, 이는 프롬프트에 명시된 대로 이미지를 처리하고 저장하는 Python 코드를 포함해야 합니다.

이 데모는 OpenVino를 활용해 사용자 입력과 이미지를 기반으로 동적으로 코드를 생성하는 사전 학습된 모델의 활용 방법을 보여줍니다.

**면책 조항**:  
이 문서는 기계 기반 AI 번역 서비스를 사용하여 번역되었습니다. 정확성을 위해 최선을 다하고 있지만, 자동 번역에는 오류나 부정확성이 포함될 수 있음을 유의하시기 바랍니다. 원어로 작성된 원본 문서를 신뢰할 수 있는 권위 있는 자료로 간주해야 합니다. 중요한 정보의 경우, 전문적인 인간 번역을 권장합니다. 이 번역 사용으로 인해 발생하는 오해나 잘못된 해석에 대해 당사는 책임을 지지 않습니다.