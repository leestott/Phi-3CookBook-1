Αυτό το demo δείχνει πώς να χρησιμοποιήσετε ένα προεκπαιδευμένο μοντέλο για να δημιουργήσετε κώδικα Python βασισμένο σε μια εικόνα και μια κειμενική προτροπή.

[Sample Code](../../../../../../code/06.E2E/E2E_OpenVino_Phi3-vision.ipynb)

Ακολουθεί μια βήμα-προς-βήμα εξήγηση:

1. **Εισαγωγές και Ρύθμιση**:
   - Εισάγονται οι απαραίτητες βιβλιοθήκες και modules, συμπεριλαμβανομένων των `requests`, `PIL` για επεξεργασία εικόνας, και `transformers` για τη διαχείριση του μοντέλου και την επεξεργασία.

2. **Φόρτωση και Εμφάνιση της Εικόνας**:
   - Ένα αρχείο εικόνας (`demo.png`) ανοίγεται χρησιμοποιώντας τη βιβλιοθήκη `PIL` και εμφανίζεται.

3. **Ορισμός της Προτροπής**:
   - Δημιουργείται ένα μήνυμα που περιλαμβάνει την εικόνα και ένα αίτημα για δημιουργία κώδικα Python για την επεξεργασία της εικόνας και την αποθήκευσή της χρησιμοποιώντας `plt` (matplotlib).

4. **Φόρτωση του Επεξεργαστή**:
   - Ο `AutoProcessor` φορτώνεται από ένα προεκπαιδευμένο μοντέλο που βρίσκεται στον κατάλογο `out_dir`. Αυτός ο επεξεργαστής θα διαχειριστεί τις εισόδους κειμένου και εικόνας.

5. **Δημιουργία της Προτροπής**:
   - Η μέθοδος `apply_chat_template` χρησιμοποιείται για τη μορφοποίηση του μηνύματος σε μια προτροπή κατάλληλη για το μοντέλο.

6. **Επεξεργασία των Εισόδων**:
   - Η προτροπή και η εικόνα μετατρέπονται σε tensors που μπορεί να κατανοήσει το μοντέλο.

7. **Ορισμός Παραμέτρων Δημιουργίας**:
   - Ορίζονται οι παράμετροι για τη διαδικασία δημιουργίας του μοντέλου, όπως ο μέγιστος αριθμός νέων tokens που θα δημιουργηθούν και αν θα γίνει δειγματοληψία του αποτελέσματος.

8. **Δημιουργία του Κώδικα**:
   - Το μοντέλο δημιουργεί τον κώδικα Python βασισμένο στις εισόδους και τις παραμέτρους δημιουργίας. Η `TextStreamer` χρησιμοποιείται για τη διαχείριση του αποτελέσματος, παραλείποντας την προτροπή και ειδικά tokens.

9. **Αποτέλεσμα**:
   - Ο δημιουργημένος κώδικας εκτυπώνεται και περιλαμβάνει Python κώδικα για την επεξεργασία της εικόνας και την αποθήκευσή της όπως ορίστηκε στην προτροπή.

Αυτό το demo δείχνει πώς να αξιοποιήσετε ένα προεκπαιδευμένο μοντέλο με το OpenVino για να δημιουργήσετε δυναμικά κώδικα βασισμένο σε εισόδους από χρήστη και εικόνες.

**Αποποίηση Ευθυνών**:  
Αυτό το έγγραφο έχει μεταφραστεί χρησιμοποιώντας υπηρεσίες αυτόματης μετάφρασης βασισμένες σε τεχνητή νοημοσύνη. Παρόλο που καταβάλλουμε προσπάθειες για ακρίβεια, παρακαλούμε να έχετε υπόψη ότι οι αυτόματες μεταφράσεις ενδέχεται να περιέχουν λάθη ή ανακρίβειες. Το πρωτότυπο έγγραφο στη μητρική του γλώσσα θα πρέπει να θεωρείται η αυθεντική πηγή. Για κρίσιμες πληροφορίες, συνιστάται επαγγελματική μετάφραση από άνθρωπο. Δεν φέρουμε ευθύνη για τυχόν παρανοήσεις ή παρερμηνείες που προκύπτουν από τη χρήση αυτής της μετάφρασης.