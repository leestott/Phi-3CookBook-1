# Βελτίωση του Phi3 χρησιμοποιώντας το Olive

Σε αυτό το παράδειγμα θα χρησιμοποιήσετε το Olive για να:

1. Προσαρμόσετε έναν LoRA adapter ώστε να ταξινομεί φράσεις στις κατηγορίες Sad, Joy, Fear, Surprise.
1. Συγχωνεύσετε τα βάρη του adapter με το βασικό μοντέλο.
1. Βελτιστοποιήσετε και ποσοτικοποιήσετε το μοντέλο σε `int4`.

Θα σας δείξουμε επίσης πώς να κάνετε inference στο βελτιωμένο μοντέλο χρησιμοποιώντας το ONNX Runtime (ORT) Generate API.

> **⚠️ Για τη διαδικασία βελτίωσης, θα χρειαστείτε κατάλληλη GPU - για παράδειγμα, A10, V100, A100.**

## 💾 Εγκατάσταση

Δημιουργήστε ένα νέο Python virtual environment (για παράδειγμα, χρησιμοποιώντας `conda`):

```bash
conda create -n olive-ai python=3.11
conda activate olive-ai
```

Στη συνέχεια, εγκαταστήστε το Olive και τις εξαρτήσεις για τη ροή εργασίας βελτίωσης:

```bash
cd Phi-3CookBook/code/04.Finetuning/olive-ort-example
pip install olive-ai[gpu]
pip install -r requirements.txt
```

## 🧪 Βελτίωση του Phi3 χρησιμοποιώντας το Olive

Το [αρχείο διαμόρφωσης του Olive](../../../../../code/03.Finetuning/olive-ort-example/phrase-classification.json) περιέχει μια *ροή εργασίας* με τις εξής *ενότητες*:

Phi3 -> LoRA -> MergeAdapterWeights -> ModelBuilder

Σε γενικές γραμμές, αυτή η ροή εργασίας θα:

1. Βελτιώσει το Phi3 (για 150 βήματα, τα οποία μπορείτε να τροποποιήσετε) χρησιμοποιώντας τα δεδομένα από το [dataset/data-classification.json](../../../../../code/03.Finetuning/olive-ort-example/dataset/dataset-classification.json).
1. Συγχωνεύσει τα βάρη του LoRA adapter με το βασικό μοντέλο. Αυτό θα σας δώσει ένα ενιαίο μοντέλο σε μορφή ONNX.
1. Το Model Builder θα βελτιστοποιήσει το μοντέλο για το ONNX runtime *και* θα το ποσοτικοποιήσει σε `int4`.

Για να εκτελέσετε τη ροή εργασίας, τρέξτε:

```bash
olive run --config phrase-classification.json
```

Όταν το Olive ολοκληρώσει, το βελτιστοποιημένο `int4` βελτιωμένο μοντέλο Phi3 θα είναι διαθέσιμο στο: `code/04.Finetuning/olive-ort-example/models/lora-merge-mb/gpu-cuda_model`.

## 🧑‍💻 Ενσωμάτωση του βελτιωμένου Phi3 στην εφαρμογή σας 

Για να τρέξετε την εφαρμογή:

```bash
python app/app.py --phrase "cricket is a wonderful sport!" --model-path models/lora-merge-mb/gpu-cuda_model
```

Η απόκριση θα πρέπει να είναι μια μονολεκτική ταξινόμηση της φράσης (Sad/Joy/Fear/Surprise).

**Αποποίηση ευθύνης**:  
Αυτό το έγγραφο έχει μεταφραστεί χρησιμοποιώντας υπηρεσίες αυτόματης μετάφρασης με τεχνητή νοημοσύνη. Ενώ καταβάλλουμε προσπάθεια για ακρίβεια, παρακαλούμε να έχετε υπόψη ότι οι αυτόματες μεταφράσεις ενδέχεται να περιέχουν λάθη ή ανακρίβειες. Το πρωτότυπο έγγραφο στη μητρική του γλώσσα θα πρέπει να θεωρείται η αυθεντική πηγή. Για κρίσιμες πληροφορίες, συνιστάται επαγγελματική ανθρώπινη μετάφραση. Δεν φέρουμε ευθύνη για τυχόν παρεξηγήσεις ή εσφαλμένες ερμηνείες που προκύπτουν από τη χρήση αυτής της μετάφρασης.